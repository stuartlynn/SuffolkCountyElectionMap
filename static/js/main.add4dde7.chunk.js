(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,n){e.exports=n(151)},134:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(113),l=n.n(c),i=(n(134),n(135),n(15)),u=n(159),o=n(118),s=n(107),d=n(121),E=n(120),f=n(116),m=n(114),p=n(117),b=n(106),h=n(81),g=n(98),w=n(119),j=n(69),y={electionResults:null,candidates:null,selectedCandidate:null,hoverFeature:null,selectedRegion:null,basemap:"satelite",showWinner:!0},O=function(e,t){var n=t.type,a=t.payload;switch(n){case"UPDATE_CANDIDATES":return Object(j.a)({},e,{candidates:a});case"UPDATE_FEATURES":return Object(j.a)({},e,{electionResults:a});case"SELECT_CANDIDATE":return Object(j.a)({},e,{selectedCandidate:a,shoWinner:!1});case"SELECT_BASEMAP":return Object(j.a)({},e,{basemap:a});case"SET_SELECTED_REGION":return Object(j.a)({},e,{selectedRegion:a});case"SHOW_WINNER":return Object(j.a)({},e,{showWinner:!0});case"RESTORE_STATE":return Object(j.a)({},e,a);default:return e}},v=r.a.createContext(),S=n(105);function C(e){var t=Object(a.useContext)(v),n=t.state,c=t.dispatch,l=n.electionResults,w=n.selectedCandidate,j=n.basemap,y=(n.showWinner,Object(a.useRef)(null)),O=Object(a.useRef)(null),C=Object(a.useRef)(null),T=Object(a.useRef)(null),_=Object(a.useRef)(null),A=Object(a.useRef)(null),R=(Object(a.useRef)(S.a),function(e){return function(e){var t=e.getProperties()[w];return new b.b({stroke:new h.a({color:"grey",width:.1}),fill:new g.a({color:0==t?"rgba(0,0,0,0.2)":Object(S.a)(1-t)})})}});return Object(a.useEffect)(function(){T.current&&T.current.setStyle(R())},[w]),Object(a.useEffect)(function(){l&&(C.current=new p.a({features:(new f.a).readFeatures(l,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}),T.current=new m.a({source:C.current,style:R(),visible:!0}),_.current.addLayer(T.current))},[l]),Object(a.useEffect)(function(){console.log("updating basemap ",j),y.current&&O.current&&(y.current.setVisible("satelite"==j),O.current.setVisible("satelite"!=j))},[j]),Object(a.useEffect)(function(){y.current=new s.a({visible:!0,name:"satellite",source:new E.a({key:"AgLzlnwMj2gShi2VFvfbzU4z3uuSwE6Fjlp9OakfGJub-c6s9Q4WG3g4nrRQkV6s",imagerySet:"Aerial"})}),O.current=new s.a({visible:!1,name:"osm",source:new d.a}),_.current=new u.a({target:A.current,layers:[y.current,O.current],view:new o.a({center:Object(i.d)([-73.273175,40.818746]),zoom:10})}),_.current.on("click",function(e){_.current.forEachFeatureAtPixel(e.pixel,function(e){var t=e.getProperties();console.log("selected feature ",e,t),c({type:"SET_SELECTED_REGION",payload:{region:t.region,district_no:t.district_no}})})}),window.addEventListener("resize",function(){console.log("resizing map "),setTimeout(function(){return _.current.updateSize()},200)}),setTimeout(function(){return _.current.updateSize()},200)},[]),r.a.createElement("div",{className:"Map"},r.a.createElement("div",{id:"map",ref:function(e){return A.current=e},style:{width:"100%",height:"100%"}}))}var T=n(82);function _(e){var t=e.data.filter(function(e){return!["Void","district_no","region"].includes(e[0])}).map(function(e){return{y:e[0],x:100*e[1]}}).sort(function(e,t){return e.x>t.x?1:e.x<t.x?-1:0});return console.log(t),r.a.createElement("div",{className:"barChart"},r.a.createElement("h3",null,t[t.length-1].y," Won with ",t[t.length-1].x.toFixed(0),"% of the vote"),r.a.createElement(T.c,{yType:"ordinal",width:300,height:200,margin:{left:150}},r.a.createElement(T.b,null),r.a.createElement(T.d,null),r.a.createElement(T.a,{data:t})))}function A(e){var t=Object(a.useContext)(v),n=t.state,c=(t.dispatch,n.selectedRegion),l=n.selectedCandidate,i=n.electionResults;return r.a.createElement("div",{className:"Stats"},r.a.createElement("div",{className:"Candidate"},r.a.createElement("h1",null,l," ")),r.a.createElement("div",{className:"Region"},c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,c.region," : ",c.district_no),r.a.createElement(_,{data:Object.entries(i.features.find(function(e){return e.properties.region==c.region&&e.properties.district_no==c.district_no}).properties)}))))}function R(e){var t=Object(a.useContext)(v),n=t.state,c=t.dispatch,l=n.candidates,i=n.selectedCandidate,u=n.basemap;return console.log("state ",n," candidates ",l),r.a.createElement("div",{className:"LayerPicker"},r.a.createElement("p",null,"Basemap"),r.a.createElement("hr",null),r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){return c({type:"SELECT_BASEMAP",payload:"satelite"})},style:"satelite"==u?{fontWeight:"bold"}:{}},"Satelite"),r.a.createElement("li",{onClick:function(){return c({type:"SELECT_BASEMAP",payload:"streets"})},style:"streets"==u?{fontWeight:"bold"}:{}},"Streets")),r.a.createElement("br",null),r.a.createElement("p",null,"Candidates"),r.a.createElement("hr",null),l&&r.a.createElement("ul",null,l.map(function(e){return r.a.createElement("li",{onClick:function(){return c({type:"SELECT_CANDIDATE",payload:e})},key:e,style:e==i?{fontWeight:"bold"}:{}},e)})),r.a.createElement("p",null,"Other"),r.a.createElement("hr",null),r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){return c({type:"SELECT_WINNER"})}},"Winner")))}n(150);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(function(e){var t=e.children,n=Object(a.useReducer)(O,y),c=Object(w.a)(n,2),l=c[0],i={state:l,dispatch:c[1]};return Object(a.useEffect)(function(){localStorage.getItem("store")},[]),Object(a.useEffect)(function(){},[l]),r.a.createElement(v.Provider,{value:i},t)},null,r.a.createElement(function(e){var t=Object(a.useContext)(v),n=(t.state,t.dispatch);return Object(a.useEffect)(function(){fetch("".concat("/SuffolkCountyElectionMap","/suffolk_county_wide_form.geojson")).then(function(e){return e.json()}).then(function(e){n({type:"UPDATE_FEATURES",payload:e}),n({type:"UPDATE_CANDIDATES",payload:Object.keys(e.features[0].properties).filter(function(e){return!["Void","region","district_no"].includes(e)})})})},[]),r.a.createElement("div",{className:"App"},r.a.createElement(C,null),r.a.createElement(A,null),r.a.createElement(R,null))},null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[129,1,2]]]);
//# sourceMappingURL=main.add4dde7.chunk.js.map